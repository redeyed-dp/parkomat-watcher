{% extends "template.html" %}
{% import 'bootstrap/wtf.html' as wtf %}
{% block app_content %}
<div class="row-fluid">
    <div class="col-12 p-4">
        <a class="btn btn-sm btn-light" href="{{ url_for('index') }}">
            <img src="{{ url_for('static', filename='img/back.png') }}"> Назад
        </a>
    </div>
</div>
<div class="row m-4">
    <div class="col-6">
        {{ wtf.quick_form(form, form_type="inline") }}
    </div>
    <div class="col-6 text-right">
        {% set devname = {
            'coin': 'монетоприемника',
            'validator': 'купюроприемника',
            'nfc': 'NFC Exellio',
            'printer': 'принтера'
        } %}
        <h3> Рейтинг отпаданий {{ devname[device] }}</h3>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <table class="table table-sm table-hover border border-dark">
            <thead class="thead-dark">
            <tr>
                <th>#</th>
                {% for day in days %}
                    <th>{{ day }}</th>
                {% endfor %}
                <th>Всего</th>
            </tr>
            </thead>
            <tbody>
            {% if sortby == 'error' %}
                {% for parkomat, totaldrops in total | dictsort(true, 'value', reverse=true) %}
                    <tr>
                        <td class="bg-dark text-light"> {{ parkomat }} </td>
                        {% for day in days %}
                            <td> {{ drops[parkomat][day] }} </td>
                        {% endfor %}

                        {% if totaldrops > 0 %}
                            <td class="text-danger"> {{ totaldrops }} </td>
                        {% else %}
                            <td class="text-success"> {{ totaldrops }} </td>
                        {% endif %}
                    </tr>
                {% endfor %}
            {% else %}
                {% for parkomat in total %}
                    <tr>
                        <td class="bg-dark text-light"> {{ parkomat }} </td>
                        {% for day in days %}
                            <td> {{ drops[parkomat][day] }} </td>
                        {% endfor %}

                        {% if total[parkomat] > 0 %}
                            <td class="text-danger"> {{ total[parkomat] }} </td>
                        {% else %}
                            <td class="text-success"> {{ total[parkomat] }} </td>
                        {% endif %}
                    </tr>
                {% endfor %}
            {% endif %}
            </tbody>
        </table>
    </div>
</div>

{% endblock %}

{% block styles %}
    {{ super() }}
    <link href="{{ url_for('static', filename='css/table_fixed.css') }}" rel="stylesheet">
{% endblock %}
